<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>NuEdit Nano-Simulation</title>
    <style>
        body { background: #010409; color: #00f2ff; font-family: 'Courier New', monospace; padding: 50px; overflow: hidden; }
        .monitor { border: 2px solid #1a2a3a; padding: 30px; position: relative; background: #000; box-shadow: 0 0 50px rgba(0, 242, 255, 0.1); }
        .dna-vessel { height: 200px; display: flex; align-items: center; justify-content: center; position: relative; margin: 50px 0; border: 1px solid #30363d; }
        
        .strand { font-size: 3rem; letter-spacing: 15px; font-weight: bold; transition: all 1s; z-index: 1; }
        .mutation { color: #f85149; text-shadow: 0 0 10px #f85149; }
        
        /* Cas9 로봇 팔 애니메이션 */
        .cas9-unit { 
            position: absolute; font-size: 5rem; top: -50px; left: -100px; 
            transition: all 3s ease-in-out; opacity: 0; z-index: 10;
        }
        
        .status-panel { background: #0d1117; padding: 20px; border-top: 1px solid #00f2ff; height: 150px; overflow-y: auto; }
        .success-flash { animation: flash 0.5s infinite; }
        @keyframes flash { 50% { opacity: 0.3; } }
    </style>
</head>
<body>
    <div class="monitor">
        <h2>CORE SIMULATION: TARGETING TP53 MUTATION</h2>
        <div class="dna-vessel">
            <div id="cas9" class="cas9-unit">✂️</div>
            <div id="dnaDisplay" class="strand"></div>
        </div>
        <div id="log" class="status-panel">
            > SYSTEM READY. WAITING FOR DNA STREAM...
        </div>
    </div>

    <script>
        const input = localStorage.getItem('targetDNA');
        const display = document.getElementById('dnaDisplay');
        const log = document.getElementById('log');
        const cas9 = document.getElementById('cas9');

        function addLog(msg) {
            log.innerHTML += `<br>> ${msg}`;
            log.scrollTop = log.scrollHeight;
        }

        if(input) {
            let mutation = input.includes("CAC") ? "CAC" : (input.includes("TTT") ? "TTT" : null);
            display.innerHTML = mutation ? input.replace(mutation, `<span class="mutation">${mutation}</span>`) : input;

            setTimeout(() => {
                addLog("DNA 서열 로드 완료. 암 변이 검색 중...");
            }, 1000);

            setTimeout(() => {
                if(mutation) {
                    addLog(`CRITICAL: 변이 '${mutation}' 감지됨. CRISPR-Cas9 유닛 기동.`);
                    cas9.style.opacity = "1";
                    // 변이 위치로 가위 이동 (중앙 정렬 기준)
                    const pos = input.indexOf(mutation);
                    const offset = (pos - input.length/2) * 45;
                    cas9.style.transform = `translateX(calc(50vw + ${offset}px)) translateY(80px)`;
                } else {
                    addLog("변이 미발견. 정상 세포로 판단하여 가동 중지.");
                }
            }, 3000);

            setTimeout(() => {
                if(mutation) {
                    addLog("<span style='color:white;'>[ACTION] 유전자 절단(Cleavage) 진행...</span>");
                    display.style.letterSpacing = "30px"; // 절단 효과
                    display.style.opacity = "0.5";
                }
            }, 6000);

            setTimeout(() => {
                if(mutation) {
                    addLog("<span class='success-flash' style='color:#3fb950;'>[COMPLETE] 정상 염기로 교정되었습니다. (HDR Success)</span>");
                    display.innerHTML = input.replace(mutation, "<span style='color:#3fb950;'>CGC</span>");
                    display.style.letterSpacing = "15px";
                    display.style.opacity = "1";
                    display.style.color = "#3fb950";
                }
            }, 8500);
        }
    </script>
</body>
</html>
